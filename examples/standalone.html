<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsNew Widget - Standalone Example</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 40px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        .example-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .code {
            background: #f1f3f4;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 10px 10px 0;
        }
        button:hover {
            background: #0056b3;
        }
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()">ðŸŒ™ Toggle Theme</button>
    
    <div class="container">
        <h1>WhatsNew Widget - Standalone Example</h1>
        
        <p>This page demonstrates the WhatsNew widget in a standalone environment. The widget will appear in the bottom-right corner when there are new updates.</p>
        
        <div class="example-section">
            <h3>Basic Usage</h3>
            <div class="code">
&lt;script src="https://unpkg.com/react@18/umd/react.production.min.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/@chglog/whats-new-widget/dist/index.js"&gt;&lt;/script&gt;

&lt;script&gt;
const { WhatsNewWidget } = window.ChglogWidget;

ReactDOM.render(
  React.createElement(WhatsNewWidget, {
    repositorySlug: 'your-repo-slug'
  }),
  document.getElementById('whats-new-widget')
);
&lt;/script&gt;
            </div>
        </div>
        
        <div class="example-section">
            <h3>Demo Controls</h3>
            <p>Use these buttons to test different widget configurations:</p>
            
            <button onclick="showWidget('bottom-right')">Bottom Right</button>
            <button onclick="showWidget('bottom-left')">Bottom Left</button>
            <button onclick="showWidget('top-right')">Top Right</button>
            <button onclick="showWidget('top-left')">Top Left</button>
            <button onclick="clearDismissals()">Clear Dismissals</button>
        </div>
        
        <div class="example-section">
            <h3>Features</h3>
            <ul>
                <li>âœ… Automatic theme detection (light/dark)</li>
                <li>âœ… Responsive design</li>
                <li>âœ… Smooth animations</li>
                <li>âœ… Persistent dismissal state</li>
                <li>âœ… Configurable positioning</li>
                <li>âœ… Custom styling support</li>
            </ul>
        </div>
    </div>
    
    <!-- Widget container -->
    <div id="whats-new-widget"></div>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Mock widget for demo purposes -->
    <script>
        // Mock widget implementation for demo
        let currentWidget = null;
        let isDarkTheme = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        // Mock update data
        const mockUpdate = {
            id: 'demo-update-' + Date.now(),
            title: 'New Feature: Dark Mode Support',
            summary: 'We\'ve added comprehensive dark mode support across the entire application. Toggle between light and dark themes seamlessly!',
            publishedAt: new Date().toISOString(),
            url: 'https://chglog.app/demo',
            author: {
                name: 'Chglog Team',
                avatar: 'https://avatars.githubusercontent.com/u/1?v=4'
            }
        };
        
        function createMockWidget(position = 'bottom-right') {
            // Remove existing widget
            if (currentWidget) {
                currentWidget.remove();
            }
            
            // Check if dismissed
            const storageKey = `whats-new-dismissed-demo-${mockUpdate.id}`;
            if (localStorage.getItem(storageKey)) {
                return;
            }
            
            // Create widget element
            const widget = document.createElement('div');
            widget.style.cssText = `
                position: fixed;
                ${position.includes('bottom') ? 'bottom: 16px;' : 'top: 16px;'}
                ${position.includes('right') ? 'right: 16px;' : 'left: 16px;'}
                max-width: 400px;
                min-width: 320px;
                background: ${isDarkTheme ? '#1f2937' : '#ffffff'};
                color: ${isDarkTheme ? '#f9fafb' : '#111827'};
                border: 1px solid ${isDarkTheme ? '#374151' : '#e5e7eb'};
                border-radius: 12px;
                padding: 16px;
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                z-index: 1000;
                cursor: pointer;
                box-shadow: ${isDarkTheme 
                    ? '0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2)'
                    : '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)'};
                transform: ${position.includes('bottom') ? 'translateY(100%)' : 'translateY(-100%)'};
                transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
                opacity: 0;
            `;
            
            widget.innerHTML = `
                <div style="display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 8px;">
                    <div style="flex: 1;">
                        <div style="display: flex; align-items: center;">
                            <img src="${mockUpdate.author.avatar}" alt="${mockUpdate.author.name}" 
                                 style="width: 24px; height: 24px; border-radius: 50%; margin-right: 8px;">
                            <h3 style="font-size: 16px; font-weight: 600; margin: 0 0 4px 0; line-height: 1.4;">
                                ${mockUpdate.title}
                            </h3>
                        </div>
                        <div style="font-size: 12px; opacity: 0.7; margin: 0 0 8px 0;">
                            just now â€¢ by ${mockUpdate.author.name}
                        </div>
                    </div>
                    <button onclick="dismissWidget()" 
                            style="background: none; border: none; font-size: 18px; cursor: pointer; 
                                   padding: 4px; border-radius: 4px; color: inherit; opacity: 0.7; 
                                   line-height: 1; margin-left: 8px;">Ã—</button>
                </div>
                <div style="margin: 0 0 12px 0; line-height: 1.5;">
                    ${mockUpdate.summary}
                </div>
                <div style="display: flex; align-items: center; justify-content: space-between; 
                           font-size: 12px; opacity: 0.8;">
                    <span style="background: ${isDarkTheme ? '#3b82f6' : '#2563eb'}; color: #ffffff; 
                                 padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 500;">
                        What's New
                    </span>
                    <span>Click to view â†’</span>
                </div>
            `;
            
            widget.onclick = (e) => {
                if (e.target.tagName !== 'BUTTON') {
                    window.open(mockUpdate.url, '_blank');
                    dismissWidget();
                }
            };
            
            document.body.appendChild(widget);
            currentWidget = widget;
            
            // Trigger animation
            setTimeout(() => {
                widget.style.transform = 'translate(0, 0)';
                widget.style.opacity = '1';
            }, 100);
        }
        
        function dismissWidget() {
            if (currentWidget) {
                const storageKey = `whats-new-dismissed-demo-${mockUpdate.id}`;
                localStorage.setItem(storageKey, JSON.stringify({
                    dismissed: true,
                    timestamp: Date.now(),
                    updateId: mockUpdate.id
                }));
                
                currentWidget.style.transform = currentWidget.style.transform.includes('translateY(-100%)') 
                    ? 'translateY(-100%)' : 'translateY(100%)';
                currentWidget.style.opacity = '0';
                
                setTimeout(() => {
                    if (currentWidget) {
                        currentWidget.remove();
                        currentWidget = null;
                    }
                }, 300);
            }
        }
        
        function showWidget(position) {
            // Generate new update ID to bypass dismissal
            mockUpdate.id = 'demo-update-' + Date.now();
            createMockWidget(position);
        }
        
        function clearDismissals() {
            // Clear all dismissal entries
            Object.keys(localStorage).forEach(key => {
                if (key.startsWith('whats-new-dismissed-demo-')) {
                    localStorage.removeItem(key);
                }
            });
            
            // Show widget
            showWidget('bottom-right');
        }
        
        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            document.body.style.background = isDarkTheme ? '#111827' : '#f5f5f5';
            document.body.style.color = isDarkTheme ? '#f9fafb' : '#333';
            
            const container = document.querySelector('.container');
            container.style.background = isDarkTheme ? '#1f2937' : 'white';
            container.style.color = isDarkTheme ? '#f9fafb' : '#333';
            
            // Recreate widget with new theme
            if (currentWidget) {
                const position = currentWidget.style.bottom !== '' 
                    ? (currentWidget.style.right !== '' ? 'bottom-right' : 'bottom-left')
                    : (currentWidget.style.right !== '' ? 'top-right' : 'top-left');
                dismissWidget();
                setTimeout(() => showWidget(position), 400);
            }
        }
        
        // Show initial widget
        setTimeout(() => createMockWidget(), 1000);
        
        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            isDarkTheme = e.matches;
            toggleTheme();
        });
    </script>
</body>
</html> 